
function getElement(t){return document.getElementById(t)}function setText(t,e){e.innerText=t}function setIcon(t,e){e.setAttribute("src","http://openweathermap.org/img/w/"+t+".png")}function setWeather(t,e,n,a,i,r){setText(t.main.temp,e),setIcon(t.weather[0].icon,n),setText(a.city.name.replace("Misto ",""),r),setText(t.dt_txt.split(" ")[1].substr(0,t.dt_txt.split(" ")[1].length-3),i)}function showWeather(t){setText(t.main.temp,getElement("weather__value")),setIcon(t.weather[0].icon,getElement("weather__icon")),setText(t.dt_txt.split(" ")[1].substr(0,t.dt_txt.split(" ")[1].length-3),getElement("weather__time"))}function getLocation(){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==this.readyState){var t=JSON.parse(this.response),e="https://api.openweathermap.org/data/2.5/forecast?lat="+t.loc.split(",")[0]+"&lon="+t.loc.split(",")[1]+"&units=metric&APPID=0af240dafbe5c4aae44810aa98092743";weather(e)}},t.open("GET","https://ipinfo.io/geo",!0),t.send()}function weather(t){var e=getElement("weather__icon"),n=getElement("weather__value"),a=getElement("weather__city"),i=getElement("weather__time"),r=getElement("weather__list"),o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==this.readyState){var t=JSON.parse(this.response),o=t.list[0];setWeather(o,n,e,t,i,a),r.innerHTML="",t.list.forEach(function(e){var n=e.dt_txt.split(" ")[1],a=document.createElement("div");a.innerText=n.substr(0,n.length-3),a.setAttribute("data-time",e.dt),a.onclick=function(e){for(var n=e.target,a=n.getAttribute("data-time"),i=0;i<t.list.length;i++)a==t.list[i].dt&&showWeather(t.list[i])},r.appendChild(a)}),console.log(o)}},o.open("GET",t,!0),o.send()}window.onload=function(){getLocation();var t=getElement("city");t.onchange=function(t){var e=t.target.value;if(0==e)getLocation();else{var n="http://api.openweathermap.org/data/2.5/forecast?q="+e+",ua&appid=0af240dafbe5c4aae44810aa98092743&units=metric";weather(n)}}};